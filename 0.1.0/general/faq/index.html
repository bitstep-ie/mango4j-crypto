
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Framework to help developers implement application level encryption, powered by Mango">
      
      
      
        <link rel="canonical" href="https://bitstep-ie.github.io/mango4j-crypto/0.1.0/general/faq/">
      
      
        <link rel="prev" href="../hmac-strategies/double-hmac/">
      
      
        <link rel="next" href="../appendixes/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>FAQs - mango4j-crypto</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frequently-asked-questions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="mango4j-crypto" class="md-header__button md-logo" aria-label="mango4j-crypto" data-md-component="logo">
      
  <img src="../../assets/mango-black.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mango4j-crypto
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FAQs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bitstep-ie/mango4j-crypto" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    bitstep-ie/mango4j-crypto
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../guide/guide/" class="md-tabs__link">
        
  
  
    
  
  Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../delegates/delegates/" class="md-tabs__link">
          
  
  
  Delegates

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../general/" class="md-tabs__link">
          
  
  
  ALE

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mango4j-crypto" class="md-nav__button md-logo" aria-label="mango4j-crypto" data-md-component="logo">
      
  <img src="../../assets/mango-black.png" alt="logo">

    </a>
    mango4j-crypto
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bitstep-ie/mango4j-crypto" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    bitstep-ie/mango4j-crypto
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Delegates
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Delegates
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delegates/delegates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delegates/test-delegates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Delegates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delegates/core-delegates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Delegates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delegates/aws-delegate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Delegate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    ALE
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    ALE
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encryption/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Encryption
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rotation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rotation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    HMAC
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    HMAC
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-strategies/hmac-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-strategies/single-hmac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single HMAC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-strategies/list-hmac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    List HMAC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hmac-strategies/double-hmac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Double HMAC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    FAQs
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQs
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#whats-a-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's a tenant?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-a-hmac" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's a HMAC?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-a-hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's a hash?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-an-iv" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's an IV?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-do-i-need-to-hmac-data-in-order-to-make-it-searchable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why do I need to HMAC data in order to make it searchable?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-do-i-need-to-hmac-confidential-data-in-order-to-make-it-unique" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why do I need to HMAC confidential data in order to make it unique?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-key-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is a key rotation?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-would-i-perform-a-key-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why would I perform a key rotation?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-does-re-keying-mean" class="md-nav__link">
    <span class="md-ellipsis">
      
        What does re-keying mean?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-should-i-re-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why should I re-key?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-does-mango4j-crypto-have-the-concept-of-only-1-encryption-key-but-multiple-hmac-keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why does mango4j-crypto have the concept of only 1 encryption key but multiple HMAC keys?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-dont-hmacs-have-a-reference-to-the-hmac-key-stored-alongside-them-the-same-way-encrypted-ciphertext-does" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why don't HMACs have a reference to the HMAC key stored alongside them the same way encrypted ciphertext does?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-hmac-tokenization" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is HMAC tokenization?
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendixes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Appendixes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#whats-a-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's a tenant?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-a-hmac" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's a HMAC?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-a-hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's a hash?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-an-iv" class="md-nav__link">
    <span class="md-ellipsis">
      
        What's an IV?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-do-i-need-to-hmac-data-in-order-to-make-it-searchable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why do I need to HMAC data in order to make it searchable?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-do-i-need-to-hmac-confidential-data-in-order-to-make-it-unique" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why do I need to HMAC confidential data in order to make it unique?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-key-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is a key rotation?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-would-i-perform-a-key-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why would I perform a key rotation?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-does-re-keying-mean" class="md-nav__link">
    <span class="md-ellipsis">
      
        What does re-keying mean?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-should-i-re-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why should I re-key?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-does-mango4j-crypto-have-the-concept-of-only-1-encryption-key-but-multiple-hmac-keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why does mango4j-crypto have the concept of only 1 encryption key but multiple HMAC keys?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-dont-hmacs-have-a-reference-to-the-hmac-key-stored-alongside-them-the-same-way-encrypted-ciphertext-does" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why don't HMACs have a reference to the HMAC key stored alongside them the same way encrypted ciphertext does?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-hmac-tokenization" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is HMAC tokenization?
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="frequently-asked-questions">Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permanent link">&para;</a></h1>
<h2 id="whats-a-tenant">What's a tenant?<a class="headerlink" href="#whats-a-tenant" title="Permanent link">&para;</a></h2>
<p>For applications which store data from different client applications or enterprises there is often the requirement that
we need to segregate the data belonging to each client (i.e. your application has multiple customer enterprises which
use it: Bank A, Bank B and Bank C).
<br>
Company requirements (and regulations) can sometimes dictate that the data which your application stores related to each
of these customers must be logically separated from each other. This is to limit the exposure which might happen in a
security breach. Your application could spin up 3 separate (and isolated) environments for each customer but this is
often
too costly to maintain.
<br>
An easier and equivalent way to do this is to have the concept of 'tenants' in your application. Each customer is a '
tenant'
and each tenant has separate encryption keys. So your application will store and configure tenant information (which
will
include the details of encryption and HMAC keys for each tenant).
<br>
Each operation in your application will then be within the context of one of these tenants. Any data stored
for Bank A is encrypted with an encryption key which is <em>only</em> used by Bank A, And similarly, any data stored
for Bank B is encrypted with an encryption key which is <em>only</em> used by Bank B. If your system doesn't have/need the
concept of tenants then you can just think of a tenant as "the application" in this documentation.</p>
<h2 id="whats-a-hmac">What's a HMAC?<a class="headerlink" href="#whats-a-hmac" title="Permanent link">&para;</a></h2>
<p>A HMAC is just a hash which uses a secret key to perform the hashing operation.</p>
<h2 id="whats-a-hash">What's a hash?<a class="headerlink" href="#whats-a-hash" title="Permanent link">&para;</a></h2>
<p>A hash is a one-way encryption cipher. One-way means that for a given piece of data, hashing it will produce a
ciphertext
but that ciphertext can never be used to reproduce the original value, it can never be decrypted. Hashes are useful for
storing data that needs to be matched but which we never want to risk an attacker knowing. Hashes are often used to
store
passwords in a secure system.</p>
<h2 id="whats-an-iv">What's an IV?<a class="headerlink" href="#whats-an-iv" title="Permanent link">&para;</a></h2>
<p>An IV (Initialization Vector) essentially introduces randomness into the data being encrypted. A new IV should be
generated and used for every encryption operation which means that even if you encrypt the same piece of data with the
same
secret key, the resulting ciphertext will be different. The ciphertext will always decrypt successfully to the original
data (the IV is actually stored in the clear, inside the data containing the ciphertext) but the fact that the resulting
ciphertext is
always unique for any encryption operation makes cryptanalysis more difficult to potential attackers.</p>
<h2 id="why-do-i-need-to-hmac-data-in-order-to-make-it-searchable">Why do I need to HMAC data in order to make it searchable?<a class="headerlink" href="#why-do-i-need-to-hmac-data-in-order-to-make-it-searchable" title="Permanent link">&para;</a></h2>
<p>When we encrypt a piece of data we should use an <a href="./#whats-an-iv">IV</a> as well as the secret key - so make sure to
consider using IVs in any custom <a href="https://github.com/bitstep-ie/mango4j-crypto/blob/main/mango4j-crypto-core/src/main/java/ie/bitstep/mango/crypto/core/encryption/EncryptionServiceDelegate.java">Encryption Service Delegate</a> implementations you create for your application.
Due to the fact that each time we encrypt a piece of data it never generates the same ciphertext this means
that we cannot search on that attribute. It may be tempting to think that for a search operation you could encrypt the
incoming search value and look for matching ciphertext in the DB. But since the ciphertext just generated for the
incoming
search term is guaranteed unique (due to the use of an IV) it won't match anything. The solution is to store a HMAC
value alongside any attribute that needs to be searchable. HMACs will always give the same HMAC value for the same piece
of data so they can be used for search purposes. Their irreversibility makes them very secure.</p>
<h2 id="why-do-i-need-to-hmac-confidential-data-in-order-to-make-it-unique">Why do I need to HMAC confidential data in order to make it unique?<a class="headerlink" href="#why-do-i-need-to-hmac-confidential-data-in-order-to-make-it-unique" title="Permanent link">&para;</a></h2>
<p>As explained above the encryption of confidential data always results in a unique ciphertext (due to the use of IVs) so
that particular ciphertext cannot be used to enforce a
unique constraint. The solution is to also store a HMAC for this attribute and place a unique constraint on that field
instead.</p>
<h2 id="what-is-a-key-rotation">What is a key rotation?<a class="headerlink" href="#what-is-a-key-rotation" title="Permanent link">&para;</a></h2>
<p>A key rotation is the action of changing an encryption or HMAC key that you're using right now (for a tenant) to a
different one.</p>
<h2 id="why-would-i-perform-a-key-rotation">Why would I perform a key rotation?<a class="headerlink" href="#why-would-i-perform-a-key-rotation" title="Permanent link">&para;</a></h2>
<p>Many corporate and regulatory guidelines require encryption keys to be updated when certain criteria are met. The
criteria definitions can sometimes be a bit fuzzy and there's no permanent concrete
criteria for all applications. Some criteria are usage based, e.g. changing the key after it's been used X times. Other
criteria are time based, e.g. change the key every X period.
Please consult your corporate security guidance or the appropriate regulations for prescriptions on when you need to
rotate encryption and HMAC keys
in your application.</p>
<p>The following points should also be taken into consideration when deciding when a key might need to be rotated:</p>
<ul>
<li>If a key becomes compromised then it is necessary to remove it from the system, which requires rotating to a new key
  (most likely followed by a rekey). This could happen at any time.</li>
<li>If new company or national regulations decide that the crypto period needs to be some different prescription than
  current company/regulatory requirements.</li>
<li>Some Cryptographic providers may stop being available in certain regions or deployment environments. In that case,
  application instances deployed in those environments will have
  to rotate keys onto a different cryptographic provider.</li>
</ul>
<h2 id="what-does-re-keying-mean">What does re-keying mean?<a class="headerlink" href="#what-does-re-keying-mean" title="Permanent link">&para;</a></h2>
<p>Re-keying is where after introducing a new encryption/HMAC key, some background job goes through the
database record by record, decrypting (with the old key) and re-encrypting (re-keying) with the new key(s) until there
are no more records left that use the old key(s).</p>
<h2 id="why-should-i-re-key">Why should I re-key?<a class="headerlink" href="#why-should-i-re-key" title="Permanent link">&para;</a></h2>
<p>If an encryption or HMAC key is compromised then you'll probably have to make sure that no data in your DB is encrypted
or contains HMACs calculated with that key. This means you
have to consider re-keying all the data that used that compromised key with a new encryption/HMAC key.
If your application uses HMACs for data that has a long data retention policy then it's probably unrealistic to keep
adding more and more HMAC keys over time but never being able
to remove them from the system. With each addition of a HMAC key the performance of your application will degrade
because that's one extra HMAC to calculate (and search for/and possibly store) for every HMAC operation.
If your application is multi-instance, caches keys and doesn't use the List HMAC Strategy then you'll need to re-key if
your application uses HMACs for unique constraint enforcement.</p>
<h2 id="why-does-mango4j-crypto-have-the-concept-of-only-1-encryption-key-but-multiple-hmac-keys">Why does mango4j-crypto have the concept of only 1 encryption key but multiple HMAC keys?<a class="headerlink" href="#why-does-mango4j-crypto-have-the-concept-of-only-1-encryption-key-but-multiple-hmac-keys" title="Permanent link">&para;</a></h2>
<p>When a piece of data is encrypted a reference to the encryption key is contained in the actual ciphertext along with the
encrypted data. This means that it will always be possible
to decrypt the data even if the current encryption key is changed (i.e. for a key rotation), assuming you didn't delete
the old key. HMACs however are
different, <a href="./#why-dont-hmacs-have-a-reference-to-the-hmac-key-stored-alongside-them-the-same-way-encrypted-ciphertext-does">HMACs don't have a reference to the HMAC key stored alongside them.</a>
So, once a HMAC key is updated/rotated to a new HMAC key, some
records will have HMACs calculated using the old key (since they haven't been recalculated yet) and some records will
have HMACs calculated using the new key (new records and newly
updated records). This means that there will be periods where we need to perform searches using more than 1 HMAC key
since we can't be sure what records have been calculated with
what keys unless all HMACs in the DB are recalculated with the new key (re-keyed). This is just a re-statement of the
HMAC key rotation challenges.</p>
<p>In a simpler statement: To decrypt something, we have already obtained the data we need to decrypt. But HMACs are used
to <em>search</em> for data, we don't know where it is yet.
Therefore, we don't know which HMAC key might have been used to HMAC it. So we have to try all the HMAC keys to search
for it.</p>
<h2 id="why-dont-hmacs-have-a-reference-to-the-hmac-key-stored-alongside-them-the-same-way-encrypted-ciphertext-does">Why don't HMACs have a reference to the HMAC key stored alongside them the same way encrypted ciphertext does?<a class="headerlink" href="#why-dont-hmacs-have-a-reference-to-the-hmac-key-stored-alongside-them-the-same-way-encrypted-ciphertext-does" title="Permanent link">&para;</a></h2>
<p>Elaborating on previous statements: It would serve no real purpose to store a reference to the HMAC key beside the HMAC
since they are used primarily for search purposes and by
definition that means that you have no information about the row where the HMAC is or even where it is in the DB. With
encrypted ciphertext it's different, you already know the
row (maybe your application accessed it directly by ID, or maybe you've searched for and found it). So once you have the
row then it's good that it has a reference to the
encryption key that was used, so now you can use that key reference to decrypt it. With HMACs you're trying to use them
to find
the row in the first place and once you've found the row,
having a reference to the HMAC key would serve no extra purpose. In summary, you never know where the HMAC you're
looking for is or which HMAC key might have been used to calculate
it, so storing the HMAC key reference alongside it won't help you with anything. And again, This is why you must try all
possible HMAC keys when searching.</p>
<p><em>Caveat:</em> In saying that, it is useful to store a reference to the HMAC key alongside the HMAC so that re-key jobs can
easily query which records need re-keyed and which do not. But this is a
convenience related to re-keying performance only and is not related to normal HMAC functionality.</p>
<h2 id="what-is-hmac-tokenization">What is HMAC tokenization?<a class="headerlink" href="#what-is-hmac-tokenization" title="Permanent link">&para;</a></h2>
<p>HMAC Tokenization is the process of chopping an input value into separate pieces and calculating HMACs for each piece
for more flexible search support. i.e. for a PAN (Primary Account Number - such as Credit Card numbers) you could
HMAC the full PAN, HMAC the last 4 digits of the PAN, HMAC the PAN without dashes/spaces giving a total of 3 resulting
HMACs for a single input. This allows you to support richer
search capabilities because now your application can support searching on the last 4 digits of the PAN and allows
searches to find a PAN whether it has dashes/spaces in it or not.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.top", "navigation.tabs", "navigation.instant", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>